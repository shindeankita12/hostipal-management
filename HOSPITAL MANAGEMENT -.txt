      HOSPITAL MANAGEMENT :-

1. Patients Table:

CREATE TABLE Patients (
    patient_id INT PRIMARY KEY,
    name VARCHAR(100),
    date_of_birth DATE,
    phone_number INT,
    email VARCHAR(100),
    gender ENUM('Male', 'Female', 'Other'),
    address VARCHAR(255),
    registration_date DATE
);

2. Doctor Table:

CREATE TABLE Doctors (
    doctor_id INT PRIMARY KEY,
    name VARCHAR(100),
    specialization VARCHAR(100),
    phone_number VARCHAR(15),
    email VARCHAR(100),
    available_days VARCHAR(50),
    consultation_fee DECIMAL(10,2)
);

3. Appointment Table:

CREATE TABLE Appointments (
    appointment_id INT PRIMARY KEY,
    patient_id INT,
    doctor_id INT,
    appointment_date DATE,
    status ENUM('Scheduled', 'Completed', 'Cancelled'),
    FOREIGN KEY (patient_id) REFERENCES Patients(patient_id),
    FOREIGN KEY (doctor_id) REFERENCES Doctors(doctor_id)
);

4. Medical Table:

CREATE TABLE Medical_Records (
    record_id INT PRIMARY KEY,
    patient_id INT,
    doctor_id INT,
    diagnosis TEXT,
    prescription TEXT,
    treatment_date DATE,
    FOREIGN KEY (patient_id) REFERENCES Patients(patient_id),
    FOREIGN KEY (doctor_id) REFERENCES Doctors(doctor_id)
);

5. Billing Table:

CREATE TABLE Billing (
    invoice_id INT PRIMARY KEY,
    patient_id INT,
    appointment_id INT,
    amount DECIMAL(10,2),
    payment_status ENUM('Paid', 'Pending', 'Cancelled'),
    payment_date DATE,
    FOREIGN KEY (patient_id) REFERENCES Patients(patient_id),
    FOREIGN KEY (appointment_id) REFERENCES Appointments(appointment_id)
);

6. Department Table:

CREATE TABLE Departments (
    department_id INT PRIMARY KEY AUTO_INCREMENT,
    department_name VARCHAR(100)
);

7.  Doctor Department:

CREATE TABLE Doctor_Department (
    doctor_id INT,
    department_id INT,
    FOREIGN KEY (doctor_id) REFERENCES Doctors(doctor_id),
    FOREIGN KEY (department_id) REFERENCES Departments(department_id),
    PRIMARY KEY (doctor_id, department_id)
);


TASKS & FUNCTIONALITIES:

(1.) Implement CRUD Operations (Low Weightage):
 INSERT INTO Patients (name, date_of_birth, gender, phone_number, email, address, registration_date)
VALUES 
('Ravi Patel', '1990-05-12', 'Male', '987654478','ravi.patel@example.com', 'Ahmedabad, Gujarat', '2025-01-10'),
('Meena Joshi', '1985-09-23', 'Female', '95467444', 'meena.joshi@example.com', 'Nikol, Ahmedabad', '2025-02-05'),
('Arjun Sharma', '2000-11-15', 'Male', '84567344', 'arjun.sharma@example.com', 'Surat, Gujarat', '2025-03-20');


 INSERT INTO Doctors (name, specialization, phone_number, email, available_days, consultation_fee)
VALUES 
('Dr. Meera Shah', 'Cardiology', '9876543210', 'meera.shah@example.com', 'Mon-Wed-Fri', 1500.00),
('Dr. Karan Desai', 'Neurology', '9123456780', 'karan.desai@example.com', 'Tue-Thu-Sat', 2000.00),
('Dr. Priya Mehta', 'Dermatology', '9988776655', 'priya.mehta@example.com', 'Mon-Fri', 1200.00);


INSERT INTO Appointments (appointment_id,patient_id, doctor_id, appointment_date, status)
VALUES 
(1,101, 1, '2025-04-01', 'Scheduled'),
(2,102, 2, '2025-04-05', 'Completed');



UPDATE Patients
SET address = 'Nikol, Ahmedabad'
WHERE patient_id = 1;



DELETE FROM Appointments
WHERE status = 'Cancelled'
  AND appointment_date < DATE_SUB(CURDATE(), INTERVAL 6 MONTH);


(2.) USE sql clauses(where,having,limit) (low weightage):

SELECT * FROM Patients
WHERE registration_date >= DATE_SUB('2025-12-25', INTERVAL 1 YEAR);



SELECT p.patient_id, p.name, SUM(b.amount) AS total_paid
FROM Patients p
JOIN Billing b ON p.patient_id = b.patient_id
WHERE b.payment_status = 'Paid'
GROUP BY p.patient_id, p.name
ORDER BY total_paid DESC
LIMIT 5;



SELECT * FROM Doctors
WHERE consultation_fee > 1000;




(3.) APPLY sql operators(and,or ,not):

SELECT * FROM Appointments
WHERE status = 'Scheduled' AND doctor_id = 3;



SELECT * FROM Doctors
WHERE specialization = 'Cardiology' OR specialization = 'Neurology';


SELECT * FROM Patients
WHERE patient_id NOT IN (
    SELECT DISTINCT patient_id
    FROM Appointments
    WHERE appointment_date >= DATE_SUB('2025-12-25', INTERVAL 1 YEAR)
);



(4.) sorting and grouping data (order by,group by):

SELECT * FROM Doctors
ORDER BY specialization ASC;


SELECT 
    d.doctor_id,
    d.name,
    COUNT(a.patient_id) AS total_patients
FROM Doctors d
LEFT JOIN Appointments a ON d.doctor_id = a.doctor_id
GROUP BY d.doctor_id, d.name;



SELECT 
    dep.department_name,
    SUM(b.amount) AS total_revenue
FROM Billing b
JOIN Appointments a ON b.appointment_id = a.appointment_id
JOIN Doctors d ON a.doctor_id = d.doctor_id
JOIN Doctor_Department dd ON d.doctor_id = dd.doctor_id
JOIN Departments dep ON dd.department_id = dep.department_id
WHERE b.payment_status = 'Paid'
GROUP BY dep.department_name;


(5.) USE aggregate functions(sum,avg,max,min,count):

SELECT SUM(amount) AS total_revenue
FROM Billing
WHERE payment_status = 'Paid';


SELECT 
    d.doctor_id,
    d.name,
    COUNT(a.appointment_id) AS visit_count
FROM Doctors d
JOIN Appointments a ON d.doctor_id = a.doctor_id
GROUP BY d.doctor_id, d.name
ORDER BY visit_count DESC
LIMIT 1;



SELECT AVG(consultation_fee) AS average_fee
FROM Doctors;


(6.) Establish primary and foreign key relationship:

SELECT 
    mr.record_id,
    p.name AS patient_name,
    d.name AS doctor_name,
    mr.diagnosis,
    mr.treatment_date
FROM Medical_Records mr
JOIN Patients p ON mr.patient_id = p.patient_id
JOIN Doctors d ON mr.doctor_id = d.doctor_id;



SELECT 
    b.invoice_id,
    p.name AS patient_name,
    a.appointment_date,
    b.amount,
    b.payment_status
FROM Billing b
JOIN Appointments a ON b.appointment_id = a.appointment_id
JOIN Patients p ON b.patient_id = p.patient_id;


(7.) Implement joins :


SELECT 
    d.doctor_id,
    d.name,
    dep.department_name
FROM Doctors d
INNER JOIN Doctor_Department dd ON d.doctor_id = dd.doctor_id
INNER JOIN Departments dep ON dd.department_id = dep.department_id;


SELECT 
    p.patient_id,
    p.name,
    a.status
FROM Patients p
LEFT JOIN Appointments a ON p.patient_id = a.patient_id
WHERE a.status = 'Completed';



SELECT 
    a.appointment_id,
    a.patient_id,
    b.invoice_id
FROM Billing b
RIGHT JOIN Appointments a ON b.appointment_id = a.appointment_id
WHERE b.invoice_id IS NULL;



SELECT p.patient_id, p.name
FROM Patients p
LEFT JOIN Appointments a ON p.patient_id = a.patient_id
WHERE a.appointment_id IS NULL

UNION

SELECT p.patient_id, p.name
FROM Patients p
RIGHT JOIN Appointments a ON p.patient_id = a.patient_id
WHERE a.appointment_id IS NULL;

(8.) Use subqueries:

SELECT doctor_id, name
FROM Doctors
WHERE doctor_id IN (
    SELECT doctor_id
    FROM Appointments
    GROUP BY doctor_id
    HAVING COUNT(patient_id) > 50
);


SELECT p.patient_id, p.name, SUM(b.amount) AS total_spent
FROM Patients p
JOIN Billing b ON p.patient_id = b.patient_id
GROUP BY p.patient_id, p.name
ORDER BY total_spent DESC
LIMIT 1;


SELECT * FROM Appointments
WHERE doctor_id IN (
    SELECT doctor_id
    FROM Doctors
    WHERE specialization = 'Dermatology'
);



(9.) Implement date and time function:

SELECT 
    MONTH(appointment_date) AS visit_month,
    COUNT(*) AS total_visits
FROM Appointments
GROUP BY MONTH(appointment_date);



SELECT 
    patient_id,
    DATEDIFF(discharge_date, admission_date) AS stay_duration_days
FROM Hospital_Stay;



SELECT 
    record_id,
    DATE_FORMAT(treatment_date, '%d-%m-%Y') AS formatted_date
FROM Medical_Records;



(10.) Use string manuipulation functions:

SELECT 
    patient_id,
    UPPER(name) AS name_upper
FROM Patients;



SELECT 
    doctor_id,
    TRIM(name) AS trimmed_name
FROM Doctors;



SELECT 
    doctor_id,
    IFNULL(phone_number, 'Not Available') AS phone_status
FROM Doctors;


(11.) Implement window functions:

SELECT 
    d.doctor_id,
    d.name,
    COUNT(a.patient_id) AS total_patients,
    RANK() OVER (ORDER BY COUNT(a.patient_id) DESC) AS doctor_rank
FROM Doctors d
JOIN Appointments a ON d.doctor_id = a.doctor_id
GROUP BY d.doctor_id, d.name;


SELECT 
    MONTH(payment_date) AS month,
    SUM(amount) AS monthly_revenue,
    SUM(SUM(amount)) OVER (ORDER BY MONTH(payment_date)) AS cumulative_revenue
FROM Billing
WHERE payment_status = 'Paid'
GROUP BY MONTH(payment_date);



SELECT 
    appointment_date,
    COUNT(*) AS daily_appointments,
    SUM(COUNT(*)) OVER (ORDER BY appointment_date) AS running_total
FROM Appointments
GROUP BY appointment_date;


(12.) Apply sql case expression:

SELECT 
    p.patient_id,
    p.name,
    COUNT(m.record_id) AS total_records,
    CASE
        WHEN COUNT(m.record_id) > 5 THEN 'High'
        WHEN COUNT(m.record_id) BETWEEN 3 AND 5 THEN 'Medium'
        ELSE 'Low'
    END AS Patient_Risk_Level
FROM Patients p
LEFT JOIN Medical_Records m ON p.patient_id = m.patient_id
GROUP BY p.patient_id, p.name;




SELECT 
    doctor_id,
    name,
    years_of_experience,
    CASE
        WHEN years_of_experience > 15 THEN 'Senior'
        WHEN years_of_experience BETWEEN 5 AND 15 THEN 'Mid-Level'
        ELSE 'Junior'
    END AS experience_level
FROM Doctors;








